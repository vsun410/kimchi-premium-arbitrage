"""
Setup Notion Executive Dashboard
NotionÏóê Executive Control SystemÏùÑ ÏúÑÌïú Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ÏôÄ ÎåÄÏãúÎ≥¥Îìú ÏÉùÏÑ±
"""

import os
import asyncio
from typing import Dict, List, Optional
from datetime import datetime
from notion_client import Client
import json


class NotionExecutiveDashboardSetup:
    """
    NotionÏóê Executive Control Dashboard ÏÑ§Ï†ï
    ÌïÑÏöîÌïú Î™®Îì† Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ÏôÄ ÌéòÏù¥ÏßÄÎ•º ÏûêÎèô ÏÉùÏÑ±
    """
    
    def __init__(self, notion_token: str):
        self.notion = Client(auth=notion_token)
        self.created_resources = {}
    
    async def setup_complete_dashboard(self, parent_page_id: str) -> Dict:
        """
        ÏôÑÏ†ÑÌïú Executive Dashboard ÏÑ§Ï†ï
        
        Args:
            parent_page_id: ÎåÄÏãúÎ≥¥ÎìúÎ•º ÏÉùÏÑ±Ìï† Î∂ÄÎ™® ÌéòÏù¥ÏßÄ ID
            
        Returns:
            ÏÉùÏÑ±Îêú Î¶¨ÏÜåÏä§ ID ÎîïÏÖîÎÑàÎ¶¨
        """
        
        print("[INFO] Setting up Notion Executive Dashboard...")
        
        # 1. Î©îÏù∏ ÎåÄÏãúÎ≥¥Îìú ÌéòÏù¥ÏßÄ ÏÉùÏÑ±
        dashboard_page = await self._create_main_dashboard(parent_page_id)
        self.created_resources['dashboard_page'] = dashboard_page['id']
        
        # 2. ÌîÑÎ°úÏ†ùÌä∏ ÎπÑÏ†Ñ Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏÉùÏÑ±
        vision_db = await self._create_vision_database(dashboard_page['id'])
        self.created_resources['vision_db'] = vision_db['id']
        
        # 3. ÏûëÏóÖ Í¥ÄÎ¶¨ Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏÉùÏÑ±
        tasks_db = await self._create_tasks_database(dashboard_page['id'])
        self.created_resources['tasks_db'] = tasks_db['id']
        
        # 4. Í≤ÄÏ¶ù Í≤∞Í≥º Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏÉùÏÑ±
        validation_db = await self._create_validation_database(dashboard_page['id'])
        self.created_resources['validation_db'] = validation_db['id']
        
        # 5. ÏΩîÎìú Î∏îÎ°ù ÎùºÏù¥Î∏åÎü¨Î¶¨ ÏÉùÏÑ±
        blocks_db = await self._create_code_blocks_database(dashboard_page['id'])
        self.created_resources['blocks_db'] = blocks_db['id']
        
        # 6. ÎåÄÏãúÎ≥¥ÎìúÏóê ÏúÑÏ†Ø Ï∂îÍ∞Ä
        await self._add_dashboard_widgets(dashboard_page['id'])
        
        # 7. Ï¥àÍ∏∞ ÎπÑÏ†Ñ Î¨∏ÏÑú ÏÉùÏÑ±
        await self._create_initial_vision_document(vision_db['id'])
        
        # 8. ÌôòÍ≤Ω Î≥ÄÏàò ÌååÏùº ÏÉùÏÑ±
        await self._create_env_file()
        
        print("\n[SUCCESS] Executive Dashboard Setup Complete!")
        print(f"\n[DASHBOARD URL]: https://notion.so/{dashboard_page['id'].replace('-', '')}")
        
        return self.created_resources
    
    async def _create_main_dashboard(self, parent_id: str) -> Dict:
        """Î©îÏù∏ ÎåÄÏãúÎ≥¥Îìú ÌéòÏù¥ÏßÄ ÏÉùÏÑ±"""
        
        page = self.notion.pages.create(
            parent={"page_id": parent_id},
            properties={
                "title": [{"text": {"content": "üéØ Executive Control Dashboard"}}]
            },
            children=[
                {
                    "object": "block",
                    "type": "heading_1",
                    "heading_1": {
                        "rich_text": [{"text": {"content": "Executive Control System"}}]
                    }
                },
                {
                    "object": "block",
                    "type": "paragraph",
                    "paragraph": {
                        "rich_text": [{
                            "text": {
                                "content": "ÌîÑÎ°úÏ†ùÌä∏ ÎπÑÏ†ÑÏùÑ ÏßÄÌÇ§Î©∞ ÏΩîÎìú ÌíàÏßàÏùÑ Í¥ÄÎ¶¨ÌïòÎäî Executive Board"
                            }
                        }]
                    }
                },
                {
                    "object": "block",
                    "type": "divider",
                    "divider": {}
                },
                {
                    "object": "block",
                    "type": "callout",
                    "callout": {
                        "rich_text": [{
                            "text": {
                                "content": "Ïù¥ ÏãúÏä§ÌÖúÏùÄ LLMÏù¥ ÏÉùÏÑ±ÌïòÎäî ÏΩîÎìúÍ∞Ä ÏõêÎûò ÎπÑÏ†ÑÏóêÏÑú Î≤óÏñ¥ÎÇòÏßÄ ÏïäÎèÑÎ°ù ÏûêÎèôÏúºÎ°ú Í∞êÏãúÌïòÍ≥† Í≤ÄÏ¶ùÌï©ÎãàÎã§."
                            }
                        }],
                        "icon": {"emoji": "üõ°Ô∏è"},
                        "color": "blue_background"
                    }
                }
            ]
        )
        
        print("[OK] Created main dashboard page")
        return page
    
    async def _create_vision_database(self, parent_id: str) -> Dict:
        """ÌîÑÎ°úÏ†ùÌä∏ ÎπÑÏ†Ñ Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏÉùÏÑ±"""
        
        database = self.notion.databases.create(
            parent={"page_id": parent_id},
            title=[{"text": {"content": "üìã Project Vision & Architecture"}}],
            properties={
                "Title": {"title": {}},
                "Type": {
                    "select": {
                        "options": [
                            {"name": "Core Vision", "color": "red"},
                            {"name": "Architecture", "color": "blue"},
                            {"name": "Red Lines", "color": "orange"},
                            {"name": "Success Metrics", "color": "green"}
                        ]
                    }
                },
                "Status": {
                    "select": {
                        "options": [
                            {"name": "Active", "color": "green"},
                            {"name": "Draft", "color": "gray"},
                            {"name": "Archived", "color": "default"}
                        ]
                    }
                },
                "Last Edited": {"last_edited_time": {}},
                "Version": {"rich_text": {}},
                "Author": {"people": {}}
            }
        )
        
        print("[OK] Created vision database")
        return database
    
    async def _create_tasks_database(self, parent_id: str) -> Dict:
        """ÏûëÏóÖ Í¥ÄÎ¶¨ Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏÉùÏÑ±"""
        
        database = self.notion.databases.create(
            parent={"page_id": parent_id},
            title=[{"text": {"content": "üìù Tasks & Requirements"}}],
            properties={
                "Task ID": {"title": {}},
                "Title": {"rich_text": {}},
                "Component": {
                    "select": {
                        "options": [
                            {"name": "trading_core", "color": "purple"},
                            {"name": "ml_engine", "color": "pink"},
                            {"name": "dashboard", "color": "blue"},
                            {"name": "risk_manager", "color": "red"},
                            {"name": "data_pipeline", "color": "green"},
                            {"name": "general", "color": "gray"}
                        ]
                    }
                },
                "Status": {
                    "select": {
                        "options": [
                            {"name": "Pending", "color": "default"},
                            {"name": "In Progress", "color": "yellow"},
                            {"name": "In Review", "color": "orange"},
                            {"name": "Approved", "color": "green"},
                            {"name": "Rejected", "color": "red"},
                            {"name": "Completed", "color": "blue"}
                        ]
                    }
                },
                "Priority": {
                    "select": {
                        "options": [
                            {"name": "High", "color": "red"},
                            {"name": "Medium", "color": "yellow"},
                            {"name": "Low", "color": "gray"}
                        ]
                    }
                },
                "Effort": {"number": {"format": "number"}},
                "Dependencies": {"multi_select": {}},
                "Assigned To": {"people": {}},
                "Created": {"created_time": {}},
                "Due Date": {"date": {}},
                "Business Score": {"number": {"format": "percent"}},
                "Architecture Score": {"number": {"format": "percent"}},
                "Drift Score": {"number": {"format": "percent"}}
            }
        )
        
        # Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Î∑∞ Ï∂îÍ∞ÄÎäî ÏÉùÎûµ (Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ IDÏóêÎäî ÏßÅÏ†ë Î∏îÎ°ù Ï∂îÍ∞Ä Î∂àÍ∞Ä)
        
        print("[OK] Created tasks database")
        return database
    
    async def _create_validation_database(self, parent_id: str) -> Dict:
        """Í≤ÄÏ¶ù Í≤∞Í≥º Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏÉùÏÑ±"""
        
        database = self.notion.databases.create(
            parent={"page_id": parent_id},
            title=[{"text": {"content": "üîç Validation Results"}}],
            properties={
                "Task ID": {"title": {}},
                "Status": {
                    "select": {
                        "options": [
                            {"name": "Approved", "color": "green"},
                            {"name": "Rejected", "color": "red"},
                            {"name": "Warning", "color": "yellow"},
                            {"name": "Block Replaced", "color": "blue"}
                        ]
                    }
                },
                "Validator": {
                    "select": {
                        "options": [
                            {"name": "Vision Guardian", "color": "purple"},
                            {"name": "File Monitor", "color": "orange"},
                            {"name": "Git Hook", "color": "pink"},
                            {"name": "CI/CD", "color": "blue"}
                        ]
                    }
                },
                "Timestamp": {"date": {}},
                "Business Score": {"number": {"format": "percent"}},
                "Architecture Score": {"number": {"format": "percent"}},
                "Drift Score": {"number": {"format": "percent"}},
                "Violations": {"multi_select": {}},
                "File Path": {"rich_text": {}},
                "Commit Hash": {"rich_text": {}}
            }
        )
        
        print("[OK] Created validation database")
        return database
    
    async def _create_code_blocks_database(self, parent_id: str) -> Dict:
        """ÏΩîÎìú Î∏îÎ°ù ÎùºÏù¥Î∏åÎü¨Î¶¨ Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÏÉùÏÑ±"""
        
        database = self.notion.databases.create(
            parent={"page_id": parent_id},
            title=[{"text": {"content": "üß© Code Block Library"}}],
            properties={
                "Block ID": {"title": {}},
                "Component": {
                    "select": {
                        "options": [
                            {"name": "trading_core", "color": "purple"},
                            {"name": "ml_engine", "color": "pink"},
                            {"name": "dashboard", "color": "blue"},
                            {"name": "risk_manager", "color": "red"},
                            {"name": "data_pipeline", "color": "green"}
                        ]
                    }
                },
                "Function Name": {"rich_text": {}},
                "Description": {"rich_text": {}},
                "Version": {"rich_text": {}},
                "Replaceable": {"checkbox": {}},
                "Last Modified": {"last_edited_time": {}},
                "Performance Score": {"number": {"format": "percent"}},
                "Test Coverage": {"number": {"format": "percent"}},
                "Dependencies": {"multi_select": {}},
                "Tags": {"multi_select": {}}
            }
        )
        
        print("[OK] Created code blocks database")
        return database
    
    async def _add_dashboard_widgets(self, dashboard_id: str):
        """ÎåÄÏãúÎ≥¥ÎìúÏóê Ïã§ÏãúÍ∞Ñ ÏúÑÏ†Ø Ï∂îÍ∞Ä"""
        
        widgets = [
            {
                "object": "block",
                "type": "heading_2",
                "heading_2": {
                    "rich_text": [{"text": {"content": "üìà Real-time Metrics"}}]
                }
            },
            {
                "object": "block",
                "type": "synced_block",
                "synced_block": {
                    "synced_from": None,
                    "children": [
                        {
                            "object": "block",
                            "type": "table",
                            "table": {
                                "table_width": 4,
                                "has_column_header": True,
                                "has_row_header": False,
                                "children": [
                                    {
                                        "object": "block",
                                        "type": "table_row",
                                        "table_row": {
                                            "cells": [
                                                [{"text": {"content": "Metric"}}],
                                                [{"text": {"content": "Current"}}],
                                                [{"text": {"content": "Target"}}],
                                                [{"text": {"content": "Status"}}]
                                            ]
                                        }
                                    },
                                    {
                                        "object": "block",
                                        "type": "table_row",
                                        "table_row": {
                                            "cells": [
                                                [{"text": {"content": "Code Drift"}}],
                                                [{"text": {"content": "5.2%"}}],
                                                [{"text": {"content": "< 10%"}}],
                                                [{"text": {"content": "‚úÖ Good"}}]
                                            ]
                                        }
                                    },
                                    {
                                        "object": "block",
                                        "type": "table_row",
                                        "table_row": {
                                            "cells": [
                                                [{"text": {"content": "Vision Alignment"}}],
                                                [{"text": {"content": "92%"}}],
                                                [{"text": {"content": "> 85%"}}],
                                                [{"text": {"content": "‚úÖ Good"}}]
                                            ]
                                        }
                                    },
                                    {
                                        "object": "block",
                                        "type": "table_row",
                                        "table_row": {
                                            "cells": [
                                                [{"text": {"content": "Tasks Completed"}}],
                                                [{"text": {"content": "42/100"}}],
                                                [{"text": {"content": "100"}}],
                                                [{"text": {"content": "üîÑ Progress"}}]
                                            ]
                                        }
                                    }
                                ]
                            }
                        }
                    ]
                }
            },
            {
                "object": "block",
                "type": "heading_2",
                "heading_2": {
                    "rich_text": [{"text": {"content": "üö® Recent Alerts"}}]
                }
            },
            {
                "object": "block",
                "type": "toggle",
                "toggle": {
                    "rich_text": [{"text": {"content": "Code Validation Failures (0)"}}],
                    "children": [
                        {
                            "object": "block",
                            "type": "paragraph",
                            "paragraph": {
                                "rich_text": [{"text": {"content": "No recent failures"}}]
                            }
                        }
                    ]
                }
            },
            {
                "object": "block",
                "type": "heading_2",
                "heading_2": {
                    "rich_text": [{"text": {"content": "üîÑ Component Health"}}]
                }
            },
            {
                "object": "block",
                "type": "column_list",
                "column_list": {
                    "children": [
                        {
                            "object": "block",
                            "type": "column",
                            "column": {
                                "children": [
                                    {
                                        "object": "block",
                                        "type": "callout",
                                        "callout": {
                                            "rich_text": [{"text": {"content": "Trading Core\n‚úÖ Healthy"}}],
                                            "icon": {"emoji": "üíπ"}
                                        }
                                    }
                                ]
                            }
                        },
                        {
                            "object": "block",
                            "type": "column",
                            "column": {
                                "children": [
                                    {
                                        "object": "block",
                                        "type": "callout",
                                        "callout": {
                                            "rich_text": [{"text": {"content": "ML Engine\n‚úÖ Healthy"}}],
                                            "icon": {"emoji": "ü§ñ"}
                                        }
                                    }
                                ]
                            }
                        },
                        {
                            "object": "block",
                            "type": "column",
                            "column": {
                                "children": [
                                    {
                                        "object": "block",
                                        "type": "callout",
                                        "callout": {
                                            "rich_text": [{"text": {"content": "Dashboard\nüîÑ Building"}}],
                                            "icon": {"emoji": "üìä"}
                                        }
                                    }
                                ]
                            }
                        }
                    ]
                }
            }
        ]
        
        for widget in widgets:
            self.notion.blocks.children.append(dashboard_id, children=[widget])
        
        print("[OK] Added dashboard widgets")
    
    async def _create_initial_vision_document(self, vision_db_id: str):
        """Ï¥àÍ∏∞ ÎπÑÏ†Ñ Î¨∏ÏÑú ÏÉùÏÑ±"""
        
        vision_page = self.notion.pages.create(
            parent={"database_id": vision_db_id},
            properties={
                "Title": {"title": [{"text": {"content": "Kimchi Premium Trading System Vision"}}]},
                "Type": {"select": {"name": "Core Vision"}},
                "Status": {"select": {"name": "Active"}},
                "Version": {"rich_text": [{"text": {"content": "1.0.0"}}]}
            },
            children=[
                {
                    "object": "block",
                    "type": "heading_1",
                    "heading_1": {
                        "rich_text": [{"text": {"content": "üéØ Project Vision"}}]
                    }
                },
                {
                    "object": "block",
                    "type": "heading_2",
                    "heading_2": {
                        "rich_text": [{"text": {"content": "Core Objectives"}}]
                    }
                },
                {
                    "object": "block",
                    "type": "numbered_list_item",
                    "numbered_list_item": {
                        "rich_text": [{"text": {"content": "Ïã§ÏãúÍ∞Ñ ÍπÄÏπòÌîÑÎ¶¨ÎØ∏ÏóÑ Ï∞®ÏùµÍ±∞Îûò ÏûêÎèôÌôî"}}]
                    }
                },
                {
                    "object": "block",
                    "type": "numbered_list_item",
                    "numbered_list_item": {
                        "rich_text": [{"text": {"content": "Î¶¨Ïä§ÌÅ¨ Ï§ëÎ¶ΩÏ†Å Ìó§ÏßÄ Ìè¨ÏßÄÏÖò Ïú†ÏßÄ"}}]
                    }
                },
                {
                    "object": "block",
                    "type": "numbered_list_item",
                    "numbered_list_item": {
                        "rich_text": [{"text": {"content": "24/7 Î¨¥Ï§ëÎã® Ïö¥ÏòÅ ÏãúÏä§ÌÖú"}}]
                    }
                },
                {
                    "object": "block",
                    "type": "numbered_list_item",
                    "numbered_list_item": {
                        "rich_text": [{"text": {"content": "ML Í∏∞Î∞ò Í∞ùÍ¥ÄÏ†Å ÏßÑÏûÖ/Ï≤≠ÏÇ∞ ÏãúÍ∑∏ÎÑê"}}]
                    }
                },
                {
                    "object": "block",
                    "type": "heading_2",
                    "heading_2": {
                        "rich_text": [{"text": {"content": "üö´ Red Lines (Ï†àÎåÄ Í∏àÏßÄ)"}}]
                    }
                },
                {
                    "object": "block",
                    "type": "bulleted_list_item",
                    "bulleted_list_item": {
                        "rich_text": [{"text": {"content": "ÎèôÏãú ÏñëÎ∞©Ìñ• Ìè¨ÏßÄÏÖò ÌïúÎèÑ Ï¥àÍ≥º Í∏àÏßÄ"}}]
                    }
                },
                {
                    "object": "block",
                    "type": "bulleted_list_item",
                    "bulleted_list_item": {
                        "rich_text": [{"text": {"content": "Îã®Ïùº Í±∞Îûò ÏûêÎ≥∏Í∏à 10% Ï¥àÍ≥º Í∏àÏßÄ"}}]
                    }
                },
                {
                    "object": "block",
                    "type": "bulleted_list_item",
                    "bulleted_list_item": {
                        "rich_text": [{"text": {"content": "ÏàòÎèô Í∞úÏûÖ ÌïÑÏöîÌïú Î°úÏßÅ Í∏àÏßÄ"}}]
                    }
                },
                {
                    "object": "block",
                    "type": "bulleted_list_item",
                    "bulleted_list_item": {
                        "rich_text": [{"text": {"content": "ÌÖåÏä§Ìä∏ÎêòÏßÄ ÏïäÏùÄ ÏΩîÎìú Î∞∞Ìè¨ Í∏àÏßÄ"}}]
                    }
                },
                {
                    "object": "block",
                    "type": "heading_2",
                    "heading_2": {
                        "rich_text": [{"text": {"content": "üìä Success Metrics"}}]
                    }
                },
                {
                    "object": "block",
                    "type": "table",
                    "table": {
                        "table_width": 2,
                        "has_column_header": True,
                        "has_row_header": False,
                        "children": [
                            {
                                "object": "block",
                                "type": "table_row",
                                "table_row": {
                                    "cells": [
                                        [{"text": {"content": "Metric"}}],
                                        [{"text": {"content": "Target"}}]
                                    ]
                                }
                            },
                            {
                                "object": "block",
                                "type": "table_row",
                                "table_row": {
                                    "cells": [
                                        [{"text": {"content": "Sharpe Ratio"}}],
                                        [{"text": {"content": "> 1.5"}}]
                                    ]
                                }
                            },
                            {
                                "object": "block",
                                "type": "table_row",
                                "table_row": {
                                    "cells": [
                                        [{"text": {"content": "Max Drawdown"}}],
                                        [{"text": {"content": "< 15%"}}]
                                    ]
                                }
                            },
                            {
                                "object": "block",
                                "type": "table_row",
                                "table_row": {
                                    "cells": [
                                        [{"text": {"content": "Win Rate"}}],
                                        [{"text": {"content": "> 60%"}}]
                                    ]
                                }
                            },
                            {
                                "object": "block",
                                "type": "table_row",
                                "table_row": {
                                    "cells": [
                                        [{"text": {"content": "System Uptime"}}],
                                        [{"text": {"content": "> 99%"}}]
                                    ]
                                }
                            }
                        ]
                    }
                }
            ]
        )
        
        print("[OK] Created initial vision document")
        return vision_page
    
    async def _create_env_file(self):
        """ÌôòÍ≤Ω Î≥ÄÏàò ÌååÏùº ÏÉùÏÑ±"""
        
        env_content = f"""# Notion Executive Control System Configuration
# Generated by setup_notion_executive_dashboard.py

# Notion API Token
NOTION_TOKEN=your_notion_token_here

# Database IDs (auto-generated)
NOTION_VISION_DB={self.created_resources.get('vision_db', '')}
NOTION_TASKS_DB={self.created_resources.get('tasks_db', '')}
NOTION_VALIDATION_DB={self.created_resources.get('validation_db', '')}
NOTION_BLOCKS_DB={self.created_resources.get('blocks_db', '')}
NOTION_DASHBOARD_PAGE={self.created_resources.get('dashboard_page', '')}

# Additional Settings
VALIDATION_THRESHOLD_BUSINESS=0.8
VALIDATION_THRESHOLD_ARCHITECTURE=0.8
VALIDATION_THRESHOLD_DRIFT=0.2
"""
        
        env_path = '.env.executive'
        with open(env_path, 'w') as f:
            f.write(env_content)
        
        print(f"[OK] Created environment file: {env_path}")
        
        # Instructions ÌååÏùº ÏÉùÏÑ±
        instructions = f"""
# Executive Control System Setup Complete!

## Your Dashboard URLs:
- Main Dashboard: https://notion.so/{self.created_resources.get('dashboard_page', '').replace('-', '')}
- Vision Database: https://notion.so/{self.created_resources.get('vision_db', '').replace('-', '')}
- Tasks Database: https://notion.so/{self.created_resources.get('tasks_db', '').replace('-', '')}

## Next Steps:

1. **Update .env file**:
   - Copy the NOTION_TOKEN from your actual .env file
   - Replace 'your_notion_token_here' in .env.executive

2. **Initialize the system**:
   ```python
   python -m executive_control.initialize
   ```

3. **Set up validation hooks**:
   ```python
   python -m executive_control.claude_code_interceptor
   ```

4. **Start monitoring**:
   ```python
   python -m executive_control.monitor
   ```

## How to Use:

### Submit a new requirement:
```python
from executive_control.notion_governance_integration import NotionGovernanceIntegration

governance = NotionGovernanceIntegration(token, config)
await governance.submit_requirement("Your requirement here")
```

### Validate code:
```python
python validate.py your_file.py
```

### View dashboard:
Open Notion and navigate to the Executive Control Dashboard

## Database IDs (save these):
{json.dumps(self.created_resources, indent=2)}
"""
        
        with open('EXECUTIVE_SETUP_COMPLETE.md', 'w') as f:
            f.write(instructions)
        
        print("\n[INFO] Instructions saved to: EXECUTIVE_SETUP_COMPLETE.md")


async def main():
    """Î©îÏù∏ ÏÑ§Ï†ï Ìï®Ïàò"""
    
    # Notion ÌÜ†ÌÅ∞ ÌôïÏù∏
    notion_token = os.getenv("NOTION_TOKEN")
    if not notion_token:
        print("[ERROR] NOTION_TOKEN not found in environment variables")
        print("Please set: export NOTION_TOKEN=your_token_here")
        return
    
    # Î∂ÄÎ™® ÌéòÏù¥ÏßÄ ID ÏûÖÎ†• Î∞õÍ∏∞
    print("\n[INFO] Notion Executive Dashboard Setup")
    print("="*50)
    parent_page = input("Enter the parent page ID or URL where dashboard should be created: ").strip()
    
    # URLÏóêÏÑú ID Ï∂îÏ∂ú
    if "notion.so" in parent_page:
        # URL ÌòïÏãù: https://www.notion.so/Page-Name-xxxxx
        parent_page = parent_page.split("/")[-1].split("-")[-1]
    
    # ÌïòÏù¥Ìîà Ï∂îÍ∞Ä (ÌïÑÏöîÌïú Í≤ΩÏö∞)
    if len(parent_page) == 32 and "-" not in parent_page:
        parent_page = f"{parent_page[:8]}-{parent_page[8:12]}-{parent_page[12:16]}-{parent_page[16:20]}-{parent_page[20:]}"
    
    print(f"\nUsing parent page ID: {parent_page}")
    confirm = input("Proceed with setup? (y/n): ").strip().lower()
    
    if confirm != 'y':
        print("Setup cancelled.")
        return
    
    # ÎåÄÏãúÎ≥¥Îìú ÏÑ§Ï†ï
    setup = NotionExecutiveDashboardSetup(notion_token)
    resources = await setup.setup_complete_dashboard(parent_page)
    
    print("\n" + "="*50)
    print("üéâ Setup Complete!")
    print("="*50)
    print("\nüìã Created Resources:")
    for key, value in resources.items():
        print(f"  - {key}: {value}")
    
    print("\nüëâ Check EXECUTIVE_SETUP_COMPLETE.md for next steps!")


if __name__ == "__main__":
    asyncio.run(main())